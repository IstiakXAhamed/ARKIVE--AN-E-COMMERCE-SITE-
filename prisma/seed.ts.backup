import { prisma } from "@/lib/prisma"
import bcrypt from "bcryptjs"

async function main() {
  console.log("Start seeding...")

  // Create default site settings
  const settings = await prisma.siteSettings.upsert({
    where: { id: "main" },
    update: {},
    create: {
      id: "main",
      storeName: "ð“ð“¡ð“šð“˜ð“¥ð“”",
      storeTagline: "Curated Collections for Every Style",
      storeEmail: "contact@arkivee.com",
      storePhone: "+8801339705214",
      storeAddress: "Bangladesh",
    },
  })
  console.log("Created site settings:", settings.id)

  // Create categories
  const categories = await Promise.all([
    prisma.category.upsert({
      where: { slug: "women" },
      update: {},
      create: {
        name: "Women",
        slug: "women",
        emoji: "ðŸ‘©",
        description: "Elegant fashion for women",
        sortOrder: 1,
      },
    }),
    prisma.category.upsert({
      where: { slug: "men" },
      update: {},
      create: {
        name: "Men",
        slug: "men",
        emoji: "ðŸ‘¨",
        description: "Stylish accessories for men",
        sortOrder: 2,
      },
    }),
    prisma.category.upsert({
      where: { slug: "jewelry" },
      update: {},
      create: {
        name: "Jewelry",
        slug: "jewelry",
        emoji: "ðŸ’Ž",
        description: "Beautiful jewelry collection",
        sortOrder: 3,
      },
    }),
    prisma.category.upsert({
      where: { slug: "accessories" },
      update: {},
      create: {
        name: "Accessories",
        slug: "accessories",
        emoji: "ðŸ‘œ",
        description: "Fashion accessories",
        sortOrder: 4,
      },
    }),
  ])
  console.log("Created categories:", categories.length)

  // Create subcategories for Women
  const womenCategory = categories.find((c) => c.slug === "women")
  if (womenCategory) {
    const subcategories = await Promise.all([
      prisma.category.upsert({
        where: { slug: "churi" },
        update: {},
        create: {
          name: "Churi",
          slug: "churi",
          emoji: "ðŸ’«",
          parentId: womenCategory.id,
          sortOrder: 1,
        },
      }),
      prisma.category.upsert({
        where: { slug: "earrings" },
        update: {},
        create: {
          name: "Earrings",
          slug: "earrings",
          emoji: "ðŸ’Ž",
          parentId: womenCategory.id,
          sortOrder: 2,
        },
      }),
      prisma.category.upsert({
        where: { slug: "necklace" },
        update: {},
        create: {
          name: "Necklace",
          slug: "necklace",
          emoji: "ðŸ“¿",
          parentId: womenCategory.id,
          sortOrder: 3,
        },
      }),
      prisma.category.upsert({
        where: { slug: "bracelet" },
        update: {},
        create: {
          name: "Bracelet",
          slug: "bracelet",
          emoji: "âœ¨",
          parentId: womenCategory.id,
          sortOrder: 4,
        },
      }),
    ])
    console.log("Created subcategories:", subcategories.length)
  }

  // Create admin user
  const hashedPassword = await bcrypt.hash("admin123", 10)
  const admin = await prisma.user.upsert({
    where: { email: "admin@arkivee.com" },
    update: {},
    create: {
      name: "Super Admin",
      email: "admin@arkivee.com",
      password: hashedPassword,
      role: "superadmin",
      emailVerified: true,
    },
  })
  console.log("Created admin user:", admin.email)

  console.log("Seeding completed successfully!")
}

main()
  .catch((e) => {
    console.error(e)
    process.exit(1)
  })
  .finally(async () => {
    await prisma.$disconnect()
  })
